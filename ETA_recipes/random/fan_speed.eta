{"dpp_template_code":"# Unfortunately no realtime recipe for quTAG, as the file is not written by\n# the control software until the experiment is stopped.\n#------IMPORTS-----\n\nimport numpy as np\nimport pandas as pd\nfrom pathlib import Path\nimport os\n\nimport etabackend.tk.plot as etaplt\nimport etabackend.tk.utils as etautils\n\n#---File handling---\nfile = Path(file)\n\n#------ADJUST DELAY-----\ndelay = int(float(delay))\nbinsize = int(float(binsize))\n\neta.recipe.set_parameter(\"sync_delay\",sync_delay)\neta.recipe.set_parameter(\"bw_delay\",str(max(0,-1*delay)))\neta.recipe.set_parameter(\"fw_delay\",str(max(0,delay)))\neta.load_recipe()\n\n#------ETA PROCESSING-----\ncut=eta.clips(Path(file))\nresult= eta.run({\"timetagger1\":cut}, group='quTAG')\nfullhist=result[ch_sel]\nxdata = np.arange(fullhist.size) * binsize\n\nf=Path(file)\nDATAFOLDER = 'analyzed data'\nLABEL = expname\n\ndef save_data(file,x,y):\n    #Saves a single pixel (x,y) to be used for trouble shooting and diagnosing\n    \n    if not os.path.exists(file.parent.joinpath(f'analyzed data')):\n        os.makedirs(file.parent.joinpath(f'analyzed data'))\n    \n    savepath = str(file.parent.joinpath(f'analyzed data', file.stem) )+ \".txt\"\n    np.savetxt(savepath,np.transpose([x,y]))\n\nsave_data(file, xdata, fullhist)\n#------PLOTTING-----\n\ndf = pd.DataFrame(np.vstack((xdata, fullhist)).T, \n                  columns=['time bins', 'histogram events'])\ndf['log events'] = np.clip(df['histogram events'].values, 0.5, None)\n\ndef generate_doc(doc):\n    root = etaplt.plot_histogram(df, f,  f.parent.joinpath(DATAFOLDER), \n                                 data_name=LABEL.capitalize(), file_label=LABEL.lower(), \n                                 info=etautils.info(globals_dict=eta.compilecache_vars['quTAG'], recipe_type=LABEL))\n    doc.add_root(root)\n    return doc\n\neta.display(generate_doc, 'bokeh')\n","eta_index_table":"[{\"id\":\"var_templatejkim3bkj\",\"name\":\"file\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"C:/Users/vLab/Desktop/Lidar/tvaglas_10_3.timeres\"},{\"id\":\"var_templatejkim48wp\",\"name\":\"binsize\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"16\"},{\"id\":\"var_templatejkim2z6x\",\"name\":\"bins\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"780\"},{\"id\":\"var_templatejkim6uch\",\"name\":\"expname\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"Lifetime\"},{\"id\":\"var_templatejks89alb\",\"name\":\"ch_sel\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"t1\"},{\"id\":\"var_templatek1wj6afv\",\"name\":\"records_per_cut\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"2e5\"},{\"id\":\"var_templatek8k93yir\",\"name\":\"delay\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"0\"},{\"id\":\"var_templatek8k9432h\",\"name\":\"fw_delay\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"0\"},{\"id\":\"var_templatek8k94746\",\"name\":\"bw_delay\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"0\"},{\"id\":\"var_templatekl7sam72\",\"name\":\"sync_delay\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"0\"},{\"id\":\"var_templatekrnjx0aj\",\"name\":\"num_histograms\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"0\"},{\"id\":\"dpp_template_code\",\"name\":\"display\",\"group\":\"quTAG\",\"info\":\"\",\"config\":\"\"},{\"id\":\"vi_templatejks7yt8a\",\"name\":\"delay1-8\",\"group\":\"quTAG\",\"info\":\"游닌[1] 游닋[8] \",\"config\":\"\"},{\"id\":\"vi_templatekkwmpr79\",\"name\":\"delay2-9\",\"group\":\"quTAG\",\"info\":\"游닌[2] 游닋[9] \",\"config\":\"\"},{\"id\":\"vi_templatekkwmnnxu\",\"name\":\"delay5-10\",\"group\":\"quTAG\",\"info\":\"游닌[5] 游닋[10] \",\"config\":\"\"},{\"id\":\"vi_templatejhrlp8yt\",\"name\":\"lifetime (start=ch5, stop=ch8)[t1]\",\"group\":\"quTAG\",\"info\":\"游닌[10, 8, 103] \",\"config\":\"\"},{\"id\":\"vi_templatekbz00gz5\",\"name\":\"lifetime (start=ch5, stop=ch9)[t2]\",\"group\":\"quTAG\",\"info\":\"游닌[5, 9] \",\"config\":\"\"},{\"id\":\"vi_templatekbz03aiq\",\"name\":\"lifetime (start=ch8, stop=ch9)[t3]\",\"group\":\"quTAG\",\"info\":\"游닌[8, 9] \",\"config\":\"\"},{\"id\":\"vi_templatek6z86r0w\",\"name\":\"Time Tagger\",\"group\":\"quTAG\",\"info\":\"游닆[0, 1, 2, 3, 4, 5] \",\"config\":\"\"}]","vi_templatejhrlp8yt":"{\"nodes\":[{\"x\":145,\"y\":157,\"fixed\":true,\"initial\":true,\"text\":\"stopped\",\"marked\":true},{\"x\":461,\"y\":152,\"fixed\":true,\"text\":\"started\",\"marked\":true,\"px\":461,\"py\":152},{\"x\":454,\"y\":392,\"weight\":1,\"fixed\":true,\"text\":\"change\",\"px\":454,\"py\":392}],\"edges\":[{\"source\":0,\"target\":1,\"text\":\"10\"},{\"source\":1,\"target\":0,\"text\":\"8\"},{\"source\":1,\"target\":1,\"text\":\"10\"},{\"source\":0,\"target\":0,\"text\":\"8\"},{\"source\":1,\"target\":2,\"text\":\"103\"},{\"source\":0,\"target\":2,\"text\":\"103\"},{\"source\":2,\"target\":1,\"text\":\"10\"}],\"usercode\":\"CLOCK(c1)\\nHISTOGRAM(t1,(`bins`,`binsize`), [`num_histograms`])\\nINTEGER(histogram_number)\\n\\nstarted:\\n    c1.start()\\nstopped:\\n    c1.stop()\\n    t1[histogram_number].record(c1)\\n    \\nchange:\\n    {\\n        histogram_number +=1\\n    }\"}","var_templatejkim2z6x":null,"var_templatejkim3bkj":null,"var_templatejkim48wp":null,"var_templatejkim6uch":null,"vi_templatejks7yt8a":"{\"nodes\":[{\"x\":141,\"y\":129,\"fixed\":true,\"initial\":true,\"text\":\"a\"}],\"edges\":[{\"source\":0,\"target\":0,\"text\":\"1\"}],\"usercode\":\"a:\\n    emit(8,`fw_delay`) # here, ch1 is duplicated to ch8 with a delay of fw_delay ps\"}","var_templatejks89alb":null,"var_templatek1wj6afv":null,"vi_templatek6z86r0w":"{\"nodes\":[{\"x\":135,\"y\":77,\"fixed\":true,\"initial\":true,\"px\":135,\"py\":77}],\"edges\":[],\"usercode\":\"RFILE(timetagger1,[0,1,2,3,4,5])\"}","var_templatek8k93yir":null,"var_templatek8k9432h":null,"var_templatek8k94746":null,"vi_templatekbz00gz5":"{\"nodes\":[{\"x\":145,\"y\":157,\"fixed\":true,\"initial\":true,\"text\":\"stopped\",\"marked\":true},{\"x\":366,\"y\":174,\"fixed\":true,\"text\":\"started\",\"marked\":true}],\"edges\":[{\"source\":0,\"target\":1,\"text\":\"5\"},{\"source\":1,\"target\":0,\"text\":\"9\"},{\"source\":1,\"target\":1,\"text\":\"5\"}],\"usercode\":\"CLOCK(c2)\\nHISTOGRAM(t2,(`bins`,`binsize`))\\n\\nstarted:\\n    c2.start()\\nstopped:\\n    c2.stop()\\n    t2.record(c2)\"}","vi_templatekbz03aiq":"{\"nodes\":[{\"x\":145,\"y\":157,\"fixed\":true,\"initial\":true,\"text\":\"stopped\",\"marked\":true},{\"x\":366,\"y\":174,\"fixed\":true,\"text\":\"started\",\"marked\":true}],\"edges\":[{\"source\":0,\"target\":1,\"text\":\"8\"},{\"source\":1,\"target\":0,\"text\":\"9\"},{\"source\":1,\"target\":1,\"text\":\"8\"}],\"usercode\":\"CLOCK(c3)\\nHISTOGRAM(t3,(`bins`,`binsize`))\\n\\nstarted:\\n    c3.start()\\nstopped:\\n    c3.stop()\\n    t3.record(c3)\"}","vi_templatekkwmnnxu":"{\"nodes\":[{\"x\":141,\"y\":129,\"fixed\":true,\"initial\":true,\"text\":\"a\"}],\"edges\":[{\"source\":0,\"target\":0,\"text\":\"5\"}],\"usercode\":\"a:\\n    emit(10,`sync_delay`) # here, ch1 is duplicated to ch8 with a delay of fw_delay ps\"}","vi_templatekkwmpr79":"{\"nodes\":[{\"x\":141,\"y\":129,\"fixed\":true,\"initial\":true,\"text\":\"a\"}],\"edges\":[{\"source\":0,\"target\":0,\"text\":\"2\"}],\"usercode\":\"a:\\n    emit(9,`bw_delay`) # here, ch1 is duplicated to ch8 with a delay of fw_delay ps\"}","var_templatekl7sam72":null,"var_templatekrnjx0aj":null}